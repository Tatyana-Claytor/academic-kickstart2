!function(e){e.fn.slabText=function(t){return e("body").addClass("slabtexted"),this.each(function(){t&&e.extend(n,t);var s=e(this),a=this,n=e.extend({},e.fn.slabText.defaults,t),i=e("span.slabtext",s).length,l=i?[]:String(e.trim(s.text())).replace(/\s{2,}/g," ").split(" "),r=null,o=null,c=null,d=e(window).width(),h=s.find("a:first").attr("href")||s.attr("href"),f=h?s.find("a:first").attr("title"):"";if(!(!i&&n.minCharsPerLine&&l.join(" ").length<n.minCharsPerLine)){var p=function(){var e=jQuery('<div style="display:none;font-size:1em;margin:0;padding:0;height:auto;line-height:1;border:0;">&nbsp;</div>').appendTo(s),t=e.height();return e.remove(),t},u=function(){var t,c=s.width();if(0!=c){if(s.removeClass("slabtextdone slabtextinactive"),n.viewportBreakpoint&&n.viewportBreakpoint>d||n.headerBreakpoint&&n.headerBreakpoint>c)return void s.addClass("slabtextinactive");if(t=p(),i||!n.forceNewCharCount&&t==r)r=t;else{r=t;var u,g,m,y,v=Math.min(60,Math.floor(c/(r*n.fontRatio))),b=0,C=[],w="",k="",x="";if(0!=v&&v!=o){for(o=v;b<l.length;){for(k="";k.length<o&&(w=k,k+=l[b]+" ",!(++b>=l.length)););n.minCharsPerLine&&(g=l.slice(b).join(" "),g.length<n.minCharsPerLine&&(k+=g,w=k,b=l.length+2)),m=o-w.length,y=k.length-o,y>m&&w.length>=(n.minCharsPerLine||2)?(x=w,b--):x=k,u=e.trim(x).length,x=e("<div/>").text(x).html(),n.wrapAmpersand&&(x=x.replace(/&amp;/g,'<span class="amp">&amp;</span>')),x=e.trim(x),C.push('<span class="slabtext slabtext-linesize-'+Math.floor(u/10)+" slabtext-linelength-"+u+'">'+x+"</span>")}s.html(C.join(" ")),h&&s.wrapInner('<a href="'+h+'" '+(f?'title="'+f+'" ':"")+"/>")}}e("span.slabtext",s).each(function(){var t,s,a,i=e(this),l=i.text(),o=l.split(" ").length>1;n.postTweak&&i.css({"word-spacing":0,"letter-spacing":0}),s=c/i.width(),a=parseFloat(this.style.fontSize)||r,i.css("font-size",Math.min((a*s).toFixed(n.precision),n.maxFontSize)+"px"),t=!!n.postTweak&&c-i.width(),t&&i.css((o?"word":"letter")+"-spacing",(t/(o?l.split(" ").length-1:l.length)).toFixed(n.precision)+"px")}),s.addClass("slabtextdone"),"function"==typeof n.onRender&&n.onRender.call(a)}};u(),n.noResizeEvent||e(window).resize(function(){e(window).width()!=d&&(d=e(window).width(),clearTimeout(c),c=setTimeout(u,n.resizeThrottleTime))})}})},e.fn.slabText.defaults={fontRatio:.78,forceNewCharCount:!0,wrapAmpersand:!0,headerBreakpoint:null,viewportBreakpoint:null,noResizeEvent:!1,resizeThrottleTime:300,maxFontSize:999,postTweak:!0,precision:3,minCharsPerLine:0,onRender:null}}(jQuery),function(e){var t,s=e("body"),a=e(".story-full article"),n=e(".wrapper-nav-library"),i=e(".menu-trigger-toggle"),l=function(){var e=i.offset();"undefined"!=typeof e.left&&n.css("padding-left",e.left)};n.addClass("js-ready").addClass("is-hidden").on("click",".closelink",function(e){e.preventDefault(),n.addClass("is-hidden")}).prepend('<a class="closelink" data-action="close"><i class="icon-close"></i></a>'),i.bind("click",function(e){e.preventDefault(),n.toggleClass("is-hidden")}),l(),e(window).resize(function(){clearTimeout(t),t=setTimeout(l,100)});var r=e(".search-form-wrap"),o=e('input[name="term"]',r),c=e(".search-trigger-toggle");o.attr("placeholder","Enter a term"),n.after(r),r.addClass("js-ready").addClass("is-hidden").on("click",".closelink",function(e){e.preventDefault(),r.addClass("is-hidden")}).prepend('<a class="closelink" data-action="close"><i class="icon-close"></i></a>'),c.bind("click",function(e){e.preventDefault(),r.toggleClass("is-hidden"),r.hasClass("is-hidden")||(n.addClass("is-hidden"),o.focus())});var d=e('<footer class="story-footnotes" id="footnotes"><h1 class="hed-bleed">Footnotes</h1></footer>'),h=e(".page-story-view .storybody .component-sidenote");h.each(function(){var t,s,a,n=e(this),i=n.clone(),l=!1;i.length&&(t=i.text().trim(),l=t.match(/^\[([0-9]+)\](.*)/)),l&&(s=l[1],n.hide(),i.attr("data-fn",s).attr("id","footnote-"+s),i.html(i.html().replace(/\[([0-9])+\](&nbsp;)?/,'<sup class="fn-numeral">'+s+"</sup>")),a=e("p:contains(["+s+"])"),a.html(a.html().replace("["+s+"]",'<sup><a href="#footnote-'+s+'">'+s+"</a></sup>")),d.append(i))}),d.children(".component-sidenote").length&&(d.wrapInner('<div class="container" />'),a.after(d));var f=e(".storybody .component-gallery"),p="/files/c/fathom/theme/img/resize-full-screen-expand.svg",u="/files/c/fathom/theme/img/resize-full-screen-collapse.svg",g=function(t){var s=e(".subcomponent-imagechild.is-focus .field-wrap-asset img",t);objectFitImages(s)},m=function(t){s.addClass("has-fullscreen-gallery"),t.addClass("is-fullscreen"),e(".gallery-fullscreen .icon",t).attr("src",u)},y=function(t){s.removeClass("has-fullscreen-gallery"),t.removeClass("is-fullscreen"),e(".gallery-fullscreen .icon",t).attr("src",p)};if(f.each(function(){var t=e(this),s=e(".subcomponent-imagechild",t);s.each(function(){0==e(this).find(".field-meta").length&&e(this).append('<div class="field-meta" />')}),t.append('<a class="gallery-fullscreen" href="#fullscreen" title="Toggle full screen"><img class="icon" src="'+p+'" alt=""></a>'),t.bind("webegallery:slidechange",function(){g(t)})}).on("click",".gallery-fullscreen",function(t){var a=e(this).closest(".component-gallery");t.preventDefault(),s.hasClass("page-story-view")&&(s.hasClass("has-fullscreen-gallery")?y(a):m(a),g(a))}),s.on("keyup",function(t){if(s.hasClass("has-fullscreen-gallery")){var a=f.filter(".is-fullscreen");switch(t.keyCode){case 27:y(a);break;case 37:e('.gallery-controls [data-action="prev"]',a).trigger("click");break;case 39:e('.gallery-controls [data-action="next"]',a).trigger("click")}}}),e(".page-story-view").length){var v=e(".storybody > p").last(),b=v.length?v.html().trim():"";if(!v.length||s.hasClass("story-dpt-photo")||s.hasClass("story-dpt-drift")||(b=b.replace(/\s(\S+?)\s*(\<br\s?\/?>)*$/g,' <span class="endcap">$1</span>'),v.html(b)),s.hasClass("story-dpt-longform")||s.hasClass("story-dpt-article")||s.hasClass("story-dpt-article_secondary")){var C=e(".storybody > p:first-of-type");s.hasClass("story-dpt-longform")&&(C=e(".storybody > p:first-of-type, .storybody > hr + p")),C.each(function(){var t=e(this),s=t.length?t.html().trim():"";t.length&&s.match(/^[a-zA-Z]/)&&(s='<span class="dcap">'+s.substr(0,1)+"</span>"+(" "==s.substr(1,1)?"Â "+s.substr(2):s.substr(1)),t.html(s))})}s.hasClass("story-dpt-qAndAAA")&&e(".storybody > p").each(function(){var t=e(this);t.html().match(/^<(b|strong)>.*:\W*<\/(b|strong)>/)&&e("b, strong",t).first().addClass("interviewee")})}var w=e(".acquisition-annoyance");if(w.length){var k,x;e("form",w).append('<a class="dismiss">No thanks</a>'),k=e('<div class="modal modal-annoyance"></div>').append(e('<div class="inner"></div>').append(w)),s.append(k),x=new Webe.modal(k).show(),w.on("click",".dismiss",function(e){e.preventDefault(),x.hide()})}var T=e(".issue-about"),z=e(".close",T);z.click(function(e){e.preventDefault(),Webe.Cookie.setItem("hide_about","1",1/0,"/"),T.css({height:T.outerHeight()}),setTimeout(function(){s.addClass("is-about-hidden")},60)}),e(document).ready(function(){e(".issue-header h1.hed-bleed").slabText()}),objectFitImages()}(jQuery);